(()=>{"use strict";var e=117,t=119,a=121,n=123,o=125,s=127,r=129,i=131,d=function(){function d(l){var c=d.getSlot(l),u=d.getSlotPos(l),f=0,p=0,m="";u>=0&&u<96?(f=0,p=u-0,m="Level "+this.levelEntrance(p)):u>=96&&u<111?(f=96,m="Event flags "+(p=u-96)):111==u?(f=111,p=0,m="Current Submap (Mario)"):112==u?(f=112,p=0,m="Current Submap (Luigi)"):u>=113&&u<e?(f=113,m="Player animation "+(p=u-113)):u>=e&&u<t?(f=e,m="Overworld X Position (Mario) "+(p=u-e)):u>=t&&u<a?(f=t,m="Overworld Y Position (Mario) "+(p=u-t)):u>=a&&u<n?(f=a,m="Overworld X Position (Luigi) "+(p=u-a)):u>=n&&u<o?(f=n,m="Overworld Y Position (Luigi) "+(p=u-n)):u>=o&&u<s?(f=o,m="Pointer to Overworld X Position (Mario) "+(p=u-o)):u>=s&&u<r?(f=s,m="Pointer to Overworld Y Position (Mario) "+(p=u-s)):u>=r&&u<i?(f=r,m="Pointer to Overworld X Position (Luigi) "+(p=u-r)):u>=i&&u<133?(f=i,m="Pointer to Overworld Y Position (Luigi) "+(p=u-i)):133==u?(f=133,p=0,m="Green Switch Block flag"):134==u?(f=134,p=0,m="Yellow Switch Block flag"):135==u?(f=135,p=0,m="Blue Switch Block flag"):136==u?(f=136,p=0,m="Red Switch Block flag"):u>=137&&u<140?(f=137,p=u-137,m="Empty"):140==u?(f=140,p=0,m="Number of Events Triggered"):u>=d.ChecksumComplement&&u<d.SlotSize?(f=d.ChecksumComplement,m="Checksum Complement "+(p=u-d.ChecksumComplement)):(f=u,p=0,m="Undefined"),this.Slot=c,this.SlotName=this.slotIndexName(this.Slot),this.Region=f,this.Index=p,this.RegionText=m}return d.getSlot=function(e){return Math.floor(e/d.SlotSize)},d.getSlotPos=function(e){return e%d.SlotSize},d.prototype.slotIndexName=function(e){switch(e){case 0:return"File A";case 1:return"File B";case 2:return"File C";case 3:return"Backup A";case 4:return"Backup B";case 5:return"Backup C";default:return"Undefined"}},d.prototype.levelEntrance=function(e){return(e>36?220+e:e).toString(16).padStart(3,"0")},d.SlotSize=143,d.ChecksumComplement=141,d}();document.getElementById("open-sram-btn").addEventListener("change",(function(e){var t=e.target.files[0];t&&(b=t.name,y.addEventListener("load",C),y.readAsArrayBuffer(t))})),document.addEventListener("keypress",(function(e){if(!e.ctrlKey){var t=parseInt(e.key,16);if(!isNaN(t)){var a=t.toString(16);console.log("num press: "+a);var n=document.getElementsByClassName("selected");if(1===n.length){var o,s,r,i,l,u,f=n[0],p=parseInt(f.dataset.pos),m=f.dataset.buffer;m?(delete f.dataset.buffer,o=m+a,I(p+1)):(f.dataset.buffer=a,o=a),c[p]=parseInt(o,16),f.innerHTML=o,document.querySelector("span.text[data-pos='"+p+"']").innerHTML=T(p),H(p),s=d.getSlot(p),r=s*d.SlotSize,i=r+d.ChecksumComplement,l=function(e,t,a){var n=Math.pow(2,16);if(c&&!(c.byteLength<t)){for(var o=0,s=e;s<t;++s)o=(o+c[s])%n;console.log("total: "+a.toString(16)),console.log("sum: "+o.toString(16));var r=a-o;return console.log("checksum: "+Math.abs(r).toString(16)),console.log("assert: "+(o+r).toString(16)+" should be "+a.toString(16)),r}}(r,i,23130),u=(65280&l)>>8,x(i,255&l),x(i+1,u)}}}})),document.addEventListener("keydown",(function(e){console.log(e);var t=document.getElementsByClassName("selected");if(1===t.length){var a=t[0];console.log(a);var n=parseInt(a.dataset.pos);switch(e.key){case"ArrowLeft":e.preventDefault(),I(n-1);break;case"ArrowUp":e.preventDefault(),I(n-L);break;case"ArrowDown":e.preventDefault(),I(n+L);break;case"ArrowRight":e.preventDefault(),I(n+1)}}}),!0);var l=document.getElementById("file-info");document.getElementById("save-sram-btn").addEventListener("click",(function(e){if(console.log(e),c){var t=new Blob([c],{type:"application/octet-stream"}),a=document.createElement("a");a.href=window.URL.createObjectURL(t),a.download=b,a.click()}})),document.getElementById("hex-editor");var c,u,f=document.getElementById("offsets-col"),p=(document.getElementById("bytes-col"),document.getElementById("bytes-header")),m=document.getElementById("bytes-data"),g=(document.getElementById("chars-col"),document.getElementById("chars-header")),v=document.getElementById("chars-data"),h=document.getElementById("selection"),L=16,S=!1,y=new FileReader,b="";function C(e){console.log(e);var t=y.result;c=new Uint8Array(t),console.log(y),u=c.slice(0),console.log(c),l.innerHTML="";var a=document.createTextNode(c.byteLength+" bytes");l.appendChild(a),function(){f.innerHTML="";var e=c.byteLength,t=Math.ceil(e/L),a=(e-1).toString(16).length;w(a);for(var n=0;n<t;++n){var o=N("span",(n*L).toString(16).padStart(a,"0"));o.classList.add("offset"),f.appendChild(o)}}(),function(){m.innerHTML="";for(var e=c.byteLength,t=Math.ceil(e/L),a=0;a<t;++a){var n=a*L,o=document.createElement("div");o.classList.add("row");for(var s=0;s<L;++s){var r=n+s;if(r>=e)break;var i=N("span",P(c[r]));i.classList.add("byte"),i.dataset.pos=r.toString(),k(i,r),i.addEventListener("click",E),o.appendChild(i)}m.appendChild(o)}}(),function(){v.innerHTML="";for(var e=c.byteLength,t=Math.ceil(e/L),a=0;a<t;++a){var n=a*L,o=document.createElement("div");o.classList.add("row");for(var s=0;s<L;++s){var r=n+s;if(r>=e)break;var i=N("span",T(r));i.classList.add("text"),i.dataset.pos=r.toString(),o.appendChild(i)}v.appendChild(o)}}()}function w(e){var t=N("span","".padStart(e,"-"));t.id="offsets-header",t.classList.add("offset"),t.classList.add("header"),S||t.classList.add("hidden"),f.appendChild(t)}function k(e,t){t<143?e.classList.add("file-a"):t>=143&&t<286?e.classList.add("file-b"):t>=286&&t<429?e.classList.add("file-c"):t>=429&&t<572?(e.classList.add("file-a"),e.classList.add("backup")):t>=572&&t<715?(e.classList.add("file-b"),e.classList.add("backup")):t>=715&&t<858&&(e.classList.add("file-c"),e.classList.add("backup"))}function E(e){B();var t=e.target;t.classList.add("selected"),M(t)}function B(){for(var e=0,t=document.getElementsByClassName("selected");e<t.length;e++){var a=t[e];a.classList.remove("selected"),a.dataset.buffer&&(delete a.dataset.buffer,a.innerHTML="0"+a.innerHTML)}}function M(e){h.innerHTML="";var t=parseInt(e.dataset.pos),a=new d(t),n=e.innerHTML;console.log("pos: "+t.toString(16));var o=N("span",a.SlotName);o.classList.add("selection-data"),k(o,t),h.appendChild(o);var s=N("span",a.RegionText);s.classList.add("selection-data"),h.appendChild(s);var r=N("span",n);r.classList.add("selection-data"),h.appendChild(r)}function I(e){if(!(e<0||e>=c.byteLength)){B();var t=document.querySelector("span[data-pos='"+e+"']");null!==t&&(t.classList.add("selected"),t.scrollIntoView({behavior:"auto",block:"center",inline:"nearest"}),M(t))}}function T(e){var t=c[e];return t<32||t>126&&t<160?".":32==t||255==t?"Â ":173==t?"-":String.fromCharCode(t)}function P(e){return e.toString(16).padStart(2,"0")}function N(e,t){var a=document.createElement(e),n=document.createTextNode(t);return a.appendChild(n),a}function H(e){for(var t=u[e],a=c[e],n=0,o=document.querySelectorAll("span[data-pos='"+e+"']");n<o.length;n++){var s=o[n];a===t?s.classList.remove("changed"):s.classList.add("changed")}}function x(e,t){c[e]=t;var a=document.querySelector("span[data-pos='"+e+"']");null!==a&&(a.innerHTML=P(t),H(e))}!function(){w(2);for(var e=0;e<L;++e){var t=N("span",P(e));t.id="bytes-header-"+e,t.classList.add("byte"),t.classList.add("header"),p.appendChild(t),S||p.classList.add("hidden"),(t=N("span","-")).classList.add("char"),t.classList.add("header"),g.appendChild(t),S||g.classList.add("hidden")}}()})();
//# sourceMappingURL=bundle.js.map